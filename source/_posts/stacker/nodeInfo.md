---
title: 全栈成长之Node
date: 2019-06-15 10:59:42
tags: stack
---

# Node能解决什么问题？
- Node的首要目标是提供一种简单的，用于创建高性能服务器的开发工具
- Web服务器的瓶颈在于并发的用户量，对比JAVA和PHP的实现方式

# Node是什么？
- Node.js是一个基于chromeV8引擎的JavaScript运行环境，让JavaScript的执行效率与低端的C语言的相近的执行效率。。。
- Node.js使用了一个事件驱动、非阻塞式I/O的模型，使其轻量又高效。
- Node.js的包管理npm，是全球最大的开源库生态系统。

# Node特点
## 为什么JavaScript是单线程？
- 这是由JavaScript这门语言的用途决定的。
- web worker并没有改变JavaScript单线程的本质

## 浏览器模型
- 用户界面 - 包括地址栏、前进后退、书签栏等
- 浏览器引擎 - 在用户界面和呈现引擎之间传送指令
- 网络 - 用于网络调用，比如HTTP请求
- 用户界面后端 - 用于绘制基本的窗口小部件，UI线程和JS共用一个线程
- JavaScript解释器 - 用于解析和执行JavaScript代码
- 数据存储 - 这个是持久层。浏览器需要在硬盘上保存各种数据，例如 Cookie


## 除了JS线程和UI线程之外的其他线程
- 浏览器事件触发线程
- 定时触发器线程
- 异步HTTP请求线程

## 任务队列
1. 所有同步任务都在主线程上执行，形成一个执行栈
2. 主线程之外，还存在一个任务队列。只要异步任务有了结果，就在任务队列之中放置一个事件。
3. 一旦执行栈中的所有同步任务执行完毕，系统救护读取任务队列，看看里面有哪些事件。哪些对应的异步任务，于是结束等待状态，进入执行栈，开始执行、
4. 主线程不断重复上面的第三步。

## Event Loop
主线程从任务队列中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为Event Loop(事件循环)

## Node.js的Event Loop

1. V8引擎解析JavaScript脚本。
2. 解析后的代码，调用Node API
3. libuv库复制Node API的执行。他将不同的任务分配给不同的线程，形成一个Event Loop（事件循环），以异步的方式将任务的执行结果返回给V8引擎。
4. V8引擎再将结果返回给用户